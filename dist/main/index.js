(()=>{var ye=Object.create;var E=Object.defineProperty;var he=Object.getOwnPropertyDescriptor;var ge=Object.getOwnPropertyNames;var Ie=Object.getPrototypeOf,Se=Object.prototype.hasOwnProperty;var Te=e=>E(e,"__esModule",{value:!0});var V=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Oe=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of ge(t))!Se.call(e,a)&&a!=="default"&&E(e,a,{get:()=>t[a],enumerable:!(r=he(t,a))||r.enumerable});return e},p=e=>Oe(Te(E(e!=null?ye(Ie(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var b=V(X=>{function Qe(e,t){if(!t)return e;let r=Object.keys(t);return r.length>0&&r.forEach(a=>{let s=t[a];e.setAttribute(a,s)}),e}function Fe(e,t){if(t){let r=document.createTextNode(t);e.appendChild(r)}return e}X.createHTMLComponent=function(e){let t=new DocumentFragment;function r(a,s){a.forEach(o=>{let{name:n,attributes:d,content:i,children:f}=o,l=document.createElement(n),g=Qe(l,d),$=Fe(g,i);s.append($),f&&f.length>0&&r(f,$)})}return r(e,t),t}});var U=V((Rt,te)=>{function $e(e){return[{name:"li",attributes:{id:e._id},content:e.name,children:[{name:"input",attributes:{type:"hidden",id:"current-video",value:e.videoId}},{name:"input",attributes:{type:"hidden",class:"video-timestamp",value:e.playedAtTime}},{name:"div",content:e.userFullName,attributes:{class:"main--name-highlight",value:e.videoId}}]}]}te.exports=$e});var ie=V((fr,ne)=>{var oe=p(b());function Ke(e){let t=[{name:"li",attributes:{id:e._id},children:[{name:"span",content:`${e.firstName} "${e.nickName}" ${e.lastName}`},{name:"span",attributes:{class:"u--green-circle"}}]}];return(0,oe.createHTMLComponent)(t)}ne.exports=Ke});var L="http://localhost:3000",B=class{constructor(t=null){this.state={},this.customFn=t}updateState(t,r){this.state[t]=r}eventListener(t){let r=t.target.name,a=t.target.value;this.updateState.apply(this,[r,a])}init(t){let r=t.children;for(let a of r)if(a.nodeName==="INPUT"||a.nodeName==="SELECT"){let s=a.name;this.state[s]="",a.addEventListener("input",this.eventListener.bind(this))}}formData(){return this.state}},S=e=>{let t=document.querySelector(".error"),r=document.createTextNode(`${e.message}. Status: ${e.status}`);t.appendChild(r),setTimeout(()=>{t.innerText=""},2e4)};var z=()=>{window.location.replace(`${L}/login`)};function q(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function m(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function T(e){m(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console!="undefined"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn(new Error().stack)),new Date(NaN))}var ve=Math.pow(10,8)*24*60*60*1e3,P=6e4,A=36e5;var ht=-ve;function Q(e,t){return m(2,arguments),T(e).getTime()-T(t).getTime()}var J={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},De="trunc";function Z(e){return e?J[e]:J[De]}function O(e,t,r){m(2,arguments);var a=Q(e,t)/1e3;return Z(r==null?void 0:r.roundingMethod)(a)}function v(e,t){m(1,arguments);var r=t||{},a=r.additionalDigits==null?2:q(r.additionalDigits);if(a!==2&&a!==1&&a!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var s=We(e),o;if(s.date){var n=Ne(s.date,a);o=Ye(n.restDateString,n.year)}if(!o||isNaN(o.getTime()))return new Date(NaN);var d=o.getTime(),i=0,f;if(s.time&&(i=we(s.time),isNaN(i)))return new Date(NaN);if(s.timezone){if(f=Ce(s.timezone),isNaN(f))return new Date(NaN)}else{var l=new Date(d+i),g=new Date(0);return g.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),g.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),g}return new Date(d+i+f)}var D={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Me=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,be=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,ke=/^([+-])(\d{2})(?::?(\d{2}))?$/;function We(e){var t={},r=e.split(D.dateTimeDelimiter),a;if(r.length>2)return t;if(/:/.test(r[0])?a=r[0]:(t.date=r[0],a=r[1],D.timeZoneDelimiter.test(t.date)&&(t.date=e.split(D.timeZoneDelimiter)[0],a=e.substr(t.date.length,e.length))),a){var s=D.timezone.exec(a);s?(t.time=a.replace(s[1],""),t.timezone=s[1]):t.time=a}return t}function Ne(e,t){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),a=e.match(r);if(!a)return{year:NaN,restDateString:""};var s=a[1]?parseInt(a[1]):null,o=a[2]?parseInt(a[2]):null;return{year:o===null?s:o*100,restDateString:e.slice((a[1]||a[2]).length)}}function Ye(e,t){if(t===null)return new Date(NaN);var r=e.match(Me);if(!r)return new Date(NaN);var a=!!r[4],s=I(r[1]),o=I(r[2])-1,n=I(r[3]),d=I(r[4]),i=I(r[5])-1;if(a)return qe(t,d,i)?He(t,d,i):new Date(NaN);var f=new Date(0);return!Ve(t,o,n)||!Le(t,s)?new Date(NaN):(f.setUTCFullYear(t,o,Math.max(s,n)),f)}function I(e){return e?parseInt(e):1}function we(e){var t=e.match(be);if(!t)return NaN;var r=F(t[1]),a=F(t[2]),s=F(t[3]);return Pe(r,a,s)?r*A+a*P+s*1e3:NaN}function F(e){return e&&parseFloat(e.replace(",","."))||0}function Ce(e){if(e==="Z")return 0;var t=e.match(ke);if(!t)return 0;var r=t[1]==="+"?-1:1,a=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return Ae(a,s)?r*(a*A+s*P):NaN}function He(e,t,r){var a=new Date(0);a.setUTCFullYear(e,0,4);var s=a.getUTCDay()||7,o=(t-1)*7+r+1-s;return a.setUTCDate(a.getUTCDate()+o),a}var Ee=[31,null,31,30,31,30,31,31,30,31,30,31];function G(e){return e%400==0||e%4==0&&e%100!=0}function Ve(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(Ee[t]||(G(e)?29:28))}function Le(e,t){return t>=1&&t<=(G(e)?366:365)}function qe(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function Pe(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function Ae(e,t){return t>=0&&t<=59}var K=JSON.parse(localStorage.getItem("user")),M={headers:{"Content-Type":"application/json"},method:"POST"},j=async(e,t,r)=>{if(K){let{clubId:o,_id:n}=K;M.headers.Authorization=`${n} ${o}`}t&&(M.body=JSON.stringify(t)),r&&(M.method=r);let a=await fetch(L+e,M),s=await a.json();if(a.status>=200&&a.status<=299)return Promise.resolve(s);S(s)},y={signupJoin:async e=>{let t=await j("/signup/join",e);return Promise.resolve(t)},signupCreate:async e=>{let t=await j("/signup/create",e);return Promise.resolve(t)},search:async e=>{let t=await j("/youtube-api/search",e);return Promise.resolve(t)},addVideo:async e=>{let t=await j("/music/addVideo",e);return Promise.resolve(t)},login:async e=>{let t=await j("/login",e);return Promise.resolve(t)},getPlaylist:async e=>{let t=await j("/music/playlist/",e);return Promise.resolve(t)}};var Y=p(b());async function Ue(e,t,r){e.addEventListener("click",async a=>{let s={name:t,videoId:r,timestamp:new Date};await y.addVideo(s);let o=document.querySelector(".main--result-list");if(o){o.innerHTML="";let n=document.querySelector(".main--search-input");n.value=""}})}var k=Ue;function _e(e){let t=e.querySelector(".played-video");if(t){let r=t.value,a=e.getElementsByTagName("button")[0],s=a.querySelector(".played-video--name").innerText;k(a,s,r)}}var ee=_e;function Re(){let t=document.querySelector(".main--history-list").getElementsByTagName("li");if(t.length>0)for(let r of t)ee(r)}var W=Re;var re=p(U());function Be(e){return[{name:"li",attributes:{id:e._id},content:e.name,children:[{name:"input",attributes:{type:"hidden",class:"next-video",value:e.videoId}},{name:"div",content:e.userFullName,attributes:{class:"main--name-highlight",value:e.videoId}}]}]}var N=Be;function ze(e){return[{name:"li",attributes:{id:e._id},children:[{name:"input",attributes:{type:"hidden",class:"played-video",value:e.videoId}},{name:"button",attributes:{class:"btn--result btn--history"},children:[{name:"p",attributes:{class:"played-video--name"},content:e.name},{name:"p",content:e.userFullName,children:[{name:"span",attributes:{class:"main--timestamp"},content:` | ${e.playedAtTime}`}]}]}]}]}function Je(e){let{upNext:t,history:r}=e,a=e.upNext[0],s=document.querySelector(".main--up-next"),o=document.querySelector(".main--history-list");s.innerHTML="",o.innerHTML="",a&&(x.loadVideoById(a.videoId),t.forEach((n,d)=>{if(d===0){let i=(0,Y.createHTMLComponent)((0,re.default)(n));s.append(i),h(n.playedAtTime)}else{let i=(0,Y.createHTMLComponent)(N(n));s.append(i)}})),r.forEach(n=>{let d=(0,Y.createHTMLComponent)(ze(n));o.append(d)}),W()}var w=Je;function Ze(){let e=document.querySelector("#current-video");return e?e.getAttribute("value"):!1}var c=Ze;async function h(e){let t=new Date,r=v(e),a=O(t,r),s=x.getDuration();if(a>s){let n={videoId:c(),timestamp:new Date},d=await y.getPlaylist(n);w(d)}x.seekTo(a,!0)}var _=p(b()),ae=p(U());function Ge({video:e,count:t}){let r=document.querySelector(".main--up-next");if(t===1){x.loadVideoById(e.videoId);let a=(0,_.createHTMLComponent)((0,ae.default)(e));r.appendChild(a),h(e.playedAtTime)}else{let a=(0,_.createHTMLComponent)(N(e));r.appendChild(a)}}var se=Ge;var de=p(ie());function Xe(){return JSON.parse(localStorage.getItem("user"))}var C=Xe;function et(e,t){let r=t.getElementsByTagName("span")[1];e.active?r.className="u--green-circle":r.className="u--red-circle"}function tt(e){if(C()._id.toString()!==e._id.toString()){let r=document.getElementById(e._id);if(r)et(e,r);else{let a=document.querySelector(".main--squad-list"),s=(0,de.default)(e);a.appendChild(s)}}}var fe=tt;function rt(e){let r=document.querySelector(".main--squad-list").getElementsByTagName("li");for(let a of r){let s=a.getElementsByTagName("span")[1],o=a.id;e.toString()===o.toString()&&(s.className="u--red-circle")}}var ue=rt;function at(){u.on("updateActiveMember",fe),u.on("queueNext",w),u.on("memberLeft",ue),u.on("addToPlaylist",se),console.log("Initialized socket listeners")}var le=at;function me(){if(c()){let t=document.getElementById("video-timestamp")?.value;t&&h(t)}}var x;function st(){let e=c(),t={height:"300",width:"500",videoId:e,playerVars:{cc_load_policy:0,controls:0,disablekb:1,enablejsapi:1,fs:0,modestbranding:1,autoplay:1},events:{onReady:ot,onStateChange:nt,onError:it}};x=new YT.Player("player",t)}function ot(e){e.target.setVolume(100),console.log("Initialized youtube player"),le(),me()}function nt(e){if(e.data===YT.PlayerState.ENDED){console.log("Load next video");let t=c(),r=new Date;u.emit("queueNext",{videoId:t,timestamp:r})}}function it(e){u.emit("queueNext"),S(`Error loading video. code ${e.data}`)}var xe=st;var H=C(),u;function dt(){H?(u=io(`/${H.clubId}`,{query:{userId:H._id,clubId:H.clubId}}),u.on("connect",()=>{console.log("Club socket connected"),xe()})):z()}var ce=dt;function ft(e){let t=new DocumentFragment,r=document.createElement("ul");return r.className="main--result-list",e.items.forEach(a=>{let s=document.createElement("li"),o=document.createElement("button");o.className="btn--result";let n=document.createElement("span"),d=document.createTextNode(a.snippet.title);n.appendChild(d);let i=document.createElement("img");i.setAttribute("src",a.snippet.thumbnails.default.url),i.className="thumbnail",o.appendChild(n),o.appendChild(i),s.appendChild(o),r.appendChild(s),k(o,a.snippet.title,a.id.videoId)}),t.append(r),t}var pe=ft;async function ut(e){e.preventDefault();let t=R.formData(),r=await y.search(t),a=document.querySelector(".main--search-results");a.innerText="";let s=pe(r.results);a.appendChild(s)}var je=ut;var R=new B;window.onload=()=>{let e=document.querySelector(".main--search");R.init(e),e.addEventListener("submit",je),W(),ce()};})();
//# sourceMappingURL=index.js.map
