(()=>{var s="https://bro-cloud.herokuapp.com",u=class{constructor(t=null){this.state={},this.customFn=t}updateState(t,o){this.state[t]=o}eventListener(t){let o=t.target.name,n=t.target.value,r=t.target.innerText;this.updateState.apply(this,[o,n]),this.customFn&&this.customFn({key:o,value:n,innerText:r},this.state)}init(t,o){let n=t.children;for(let r of n)(r.nodeName==="INPUT"||r.nodeName==="SELECT")&&r.addEventListener("input",this.eventListener.bind(this));if(o){let{identifier:r,childElementType:a,eventType:h}=o,y=document.querySelector(r).getElementsByTagName(a);for(let g of y)g.addEventListener(h,this.eventListener.bind(this))}}formData(){return this.state}},d=e=>{let t=document.querySelector(".error"),o=document.createTextNode(e);t.appendChild(o),setTimeout(()=>{t.innerText=""},2e4)};var l=JSON.parse(localStorage.getItem("user")),i={headers:{"Content-Type":"application/json"},method:"POST"},c=async(e,t,o)=>{if(l){let{clubId:r,_id:a}=l;i.headers.Authorization=`${a} ${r}`}t&&(i.body=JSON.stringify(t)),o&&(i.method=o);let n=await fetch(s+e,i);if(n.status>=200&&n.status<=299){let r=await n.json();return Promise.resolve(r)}d(n.error)},m={signup:async e=>{let t=await c(`/signup/${e.url}`,e.body);return Promise.resolve(t)},search:async e=>{let t=await c("/youtube-api/search",e);return Promise.resolve(t)},addVideo:async e=>{let t=await c("/music/addVideo",e);return Promise.resolve(t)}};function b(e,t){console.log(e,t);let o=document.querySelector("#signup--btn");o.innerText="";let n;if(e.key==="clubId")return n=document.createTextNode(`Join club: ${e.innerText}`),o.setAttribute("name","join"),o.appendChild(n);if(e.key==="clubName")return n=document.createTextNode(`Create club: ${t[e.key]}`),o.setAttribute("name","create"),o.appendChild(n)}var p=b;var f=new u(p);window.onload=()=>{let e=document.querySelector(".signup--form"),t={identifier:".signup--club",childElementType:"button",eventType:"click"};f.init(e,t),e.addEventListener("submit",T)};async function T(e){e.preventDefault();let t=e.submitter.name,n={body:f.formData(),url:t},r=await m.signup(n);localStorage.setItem("user",JSON.stringify(r.user)),localStorage.setItem("userSignedUp",!0),window.location.replace(`${s}/music/${r.user.clubId}/${r.user._id}`)}})();
//# sourceMappingURL=index.js.map
