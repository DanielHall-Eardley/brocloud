(()=>{var s="http://localhost:3000",u=class{constructor(t=null){this.state={},this.customFn=t}updateState(t,n){this.state[t]=n}eventListener(t){let n=t.target.name,o=t.target.value,r=t.target.innerText;this.updateState.apply(this,[n,o]),this.customFn&&this.customFn({key:n,value:o,innerText:r},this.state)}init(t,n){let o=t.children;for(let r of o)(r.nodeName==="INPUT"||r.nodeName==="SELECT")&&r.addEventListener("input",this.eventListener.bind(this));if(n){let{identifier:r,childElementType:a,eventType:h}=n,y=document.querySelector(r).getElementsByTagName(a);for(let g of y)g.addEventListener(h,this.eventListener.bind(this))}}formData(){return this.state}},d=e=>{let t=document.querySelector(".error"),n=document.createTextNode(e);t.appendChild(n),setTimeout(()=>{t.innerText=""},2e4)};var l=JSON.parse(localStorage.getItem("user")),i={headers:{"Content-Type":"application/json"},method:"POST"},c=async(e,t,n)=>{if(l){let{clubId:r,_id:a}=l;i.headers.Authorization=`${a} ${r}`}t&&(i.body=JSON.stringify(t)),n&&(i.method=n);let o=await fetch(s+e,i);if(o.status>=200&&o.status<=299){let r=await o.json();return Promise.resolve(r)}d(o.error)},m={signup:async e=>{let t=await c(`/signup/${e.url}`,e.body);return Promise.resolve(t)},search:async e=>{let t=await c("/search",e);return Promise.resolve(t)},addVideo:async e=>{let t=await c("/addVideo",e);return Promise.resolve(t)}};function T(e,t){let n=document.querySelector("#signup--btn");n.innerText="";let o;if(e.key==="clubId")return o=document.createTextNode(`Join club: ${e.innerText}`),n.setAttribute("name","join"),n.appendChild(o);if(e.key==="clubName")return o=document.createTextNode(`Create club: ${t[e.key]}`),n.setAttribute("name","create"),n.appendChild(o)}var p=T;var f=new u(p);window.onload=()=>{let e=document.querySelector(".signup--form"),t={identifier:".signup--club",childElementType:"button",eventType:"click"};f.init(e,t),e.addEventListener("submit",b)};async function b(e){e.preventDefault();let t=e.submitter.name,o={body:f.formData(),url:t},r=await m.signup(o);localStorage.setItem("user",JSON.stringify(r.user)),window.location.replace(`${s}/music/${r.user.clubId}/${r.user._id}`)}})();
//# sourceMappingURL=index.js.map
